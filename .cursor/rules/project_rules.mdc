---
description: 
globs: 
alwaysApply: true
---
# 🧠 AI 开发指导提示：程序员开发工具集合平台（Python + PySide6）

## 📌 项目目标

本项目旨在开发一款基于 **Python + PySide6** 的程序员日常开发辅助平台，**以多工具集合为核心**，每个工具（如内存分析、性能分析、单元测试、开发小工具等）均为**独立模块**，可独立运行、互不影响，具备现代美观的 GUI 及良好的模块扩展性。主程序仅负责统一入口、模块管理与调度，保证各工具间的解耦和独立性，便于未来集成更多开发辅助功能。

---

## 🧭 主程序功能设计与模块架构

- **主窗口**：统一入口，包含导航栏、菜单栏、主题切换等。
- **模块化工具区**：每个工具为独立模块，互不影响，可单独开发、测试和运行。
    - **内存分析模块**：分配可视化（火焰图/树/时间线）。
    - **性能分析模块**：帧率波动、函数调用耗时等。
    - **单元测试模块**：测试结果解析、覆盖率可视化等。
    - **开发小工具模块**：JSON 格式化、日志搜索、正则测试等。
- **设置中心**：路径配置、主题选择、默认行为等。

**模块切换建议：**
- 主视图区用 `QTabWidget` 或 `QStackedWidget`，每个工具模块独立加载与管理。
- 左侧用 `QListView/QTreeView` 展示模块列表。
- 支持懒加载和缓存，提升性能。
- 各模块间无直接依赖，数据、状态、UI 互不干扰。

---

## 📂 输入数据说明（以内存分析工具为例）

### 1. `stack.txt`（堆栈信息文件）

- 记录所有唯一完整堆栈路径，每个堆栈有唯一 `hash`。
- 示例：
  ```
  hash: 781353984
    0x00007FFE4B90D3F4 (ntdll) NtDelayExecution
    0x00007FFE4914962E (KERNELBASE) SleepEx
    0x00007FFE38A42E8C (MSVCP140) Thrd_sleep
    0x00007FFDC2B0BE13 (AirsimWrapper) [D:\MSVC\14.29.30133\include\thread:193] std::this_thread::sleep_until<std::chrono::steady_clock,std::chrono::duration<__int64,std::ratio<1,1000000000> > > 
    0x00007FFDC2B0B8EB (AirsimWrapper) [D:\AirsimWrapper\Source\UnityToAirSimCalls.h:26] StartServer 
    0x0000012B7A956EB6 (Assembly-CSharp) AirSimUnity.PInvokeWrapper.StartServer()
    0x0000012B7A956C6B (Assembly-CSharp) AirSimUnity.AirSimServer.Start()
    0x0000012BA145FC78 (mscorlib) System.Object.runtime_invoke_void__this__()
    0x00007FFDD7FCCBA0 (mono-2.0-bdwgc) mono_get_runtime_build_info
    0x00007FFDD7F52112 (mono-2.0-bdwgc) mono_perfcounters_init
    0x00007FFDD7F5B10F (mono-2.0-bdwgc) mono_runtime_invoke
  ```

### 2. `allocations.txt`（分配记录）

- 记录内存分配信息，包括 size、hash、address、object info、可选帧号。
- 示例：
  ```
  size: 1024
  hash: 781353984
  addr: 0xFFEE1122
  object: PlayerComponent
  frame: 1320
  ```

---

## 🔄 主要分析功能（内存分析模块示例）

| 功能                | 说明                                  |
| ----------------- | ----------------------------------- |
| 🔥 火焰图           | 按堆栈路径合并分配 size，层级火焰图展示         |
| 🌳 堆栈树形图        | 分层显示堆栈结构，支持搜索/切换视图             |
| 🎮 Timeline       | 按帧显示分配量，支持点击查看帧分配详情           |
| 点击联动              | Timeline、火焰图、树形图、属性面板联动更新      |

---

## 🌟 推荐 UI 布局（平台化工具集合）

```
┌────────────────────────────────────────────────────┐
│ 顶部工具栏：加载文件 | 导出 | 主题切换 | 帮助 │
├────────────────────────────────────────────┬────────────┤
│ 左栏：模块列表（各独立工具）                 │ 属性面板 │
│                                            ├────────────┤
│   [当前工具主视图区]                        │            │
│   例如：🔥 火焰图 + 🌳 树形图（内存分析）    │            │
│         🎮 Timeline（内存分析）             │            │
│         性能分析/单元测试/开发小工具视图    │            │
└────────────────────────────────────────────┴────────────┘
```

---

## 💪 PySide6 推荐 UI 技术

| 区域       | 推荐组件                                  |
| -------- | ------------------------------------- |
| 主窗口      | `QMainWindow`                         |
| 左侧导航栏    | `QDockWidget` + `QListView/QTreeView` |
| 中间工作区    | `QStackedWidget` / `QTabWidget`       |
| Timeline | `QChartView` / `pyqtgraph`            |
| 属性面板     | `QFormLayout` + QWidget               |

---

## 🔍 数据解析结构（内存分析模块示例）

```python
class StackParser:
    def __init__(self, stack_file: str): ...
    def get_stack_by_hash(self, hash_id: str) -> List[str]

class AllocationParser:
    def __init__(self, alloc_file: str): ...
    def get_allocations_by_frame(self, frame_id: int) -> List[AllocationRecord]
    def get_total_size_by_stack(self) -> Dict[stack_hash, total_size]
```

---

## 🔄 模块交互流程（内存分析模块示例）

1. 点击 Timeline 指定帧
2. 过滤帧上的分配数据
3. 合并堆栈 hash
4. 重绘火焰图 & 树形图
5. 刷新属性面板

---

## 🌈 美化 UI 建议

| UI 元素    | 样式建议                       |
| -------- | -------------------------- |
| 配色       | 黑为主或淡色系，使用 QSS/QPalette    |
| 图标       | SVG 样式，可用 Feather/Iconify   |
| Timeline | 支持点击、点分动画、控件动画效果         |
| 属性面板     | 圆角、卡片、组合信息展示、分组显示          |
| 主题切换     | QSS 切换，或重配 QPalette        |

---

## 🏁 快速开发建议

- 每个工具模块可独立开发、测试、运行，主程序仅负责入口和调度。
- 可用 PySide6 生成主窗口和模块切换框架。
- 火焰图/Timeline 可用 pyqtgraph 或 QChartView 实现。
- 设计简洁美观的 QSS 主题，支持一键切换。

---

**如需代码模板、UI 示例或配色方案，可随时向 AI 助手提问！**

---


此提示可作为项目开发的"北极星"指引，确保团队成员和 AI 助手理解平台定位、架构和开发风格。 