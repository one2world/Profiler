<UserControl x:Class="Unity.MemoryProfiler.UI.Controls.ManagedObjectInspector"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
             mc:Ignorable="d" 
             d:DesignHeight="400" d:DesignWidth="600"
             Background="White">
    <UserControl.Resources>
        <!-- TreeViewItem样式 -->
        <Style x:Key="FieldTreeViewItemStyle" TargetType="TreeViewItem">
            <Setter Property="IsExpanded" Value="False"/>
            <Setter Property="Padding" Value="2"/>
            <Setter Property="FontSize" Value="12"/>
        </Style>
        
        <!-- 字段名样式 -->
        <Style x:Key="FieldNameStyle" TargetType="TextBlock">
            <Setter Property="FontFamily" Value="Consolas"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Foreground" Value="#333333"/>
            <Setter Property="Margin" Value="0,2,10,2"/>
        </Style>
        
        <!-- 字段值样式 -->
        <Style x:Key="FieldValueStyle" TargetType="TextBlock">
            <Setter Property="FontFamily" Value="Consolas"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Foreground" Value="#0066CC"/>
            <Setter Property="Margin" Value="0,2,10,2"/>
        </Style>
        
        <!-- 类型名样式 -->
        <Style x:Key="TypeNameStyle" TargetType="TextBlock">
            <Setter Property="FontFamily" Value="Consolas"/>
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="Foreground" Value="#666666"/>
            <Setter Property="FontStyle" Value="Italic"/>
            <Setter Property="Margin" Value="0,2,10,2"/>
        </Style>
        
        <!-- 大小样式 -->
        <Style x:Key="SizeStyle" TargetType="TextBlock">
            <Setter Property="FontFamily" Value="Consolas"/>
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="Foreground" Value="#999999"/>
            <Setter Property="Margin" Value="0,2,10,2"/>
        </Style>
        
        <!-- 备注样式 -->
        <Style x:Key="NotesStyle" TargetType="TextBlock">
            <Setter Property="FontFamily" Value="Consolas"/>
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="Foreground" Value="#CC6600"/>
            <Setter Property="FontStyle" Value="Italic"/>
            <Setter Property="Margin" Value="0,2,0,2"/>
        </Style>

        <!-- HierarchicalDataTemplate for ManagedFieldInfo -->
        <HierarchicalDataTemplate x:Key="FieldTemplate" ItemsSource="{Binding Children}">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="200" MinWidth="100"/>
                    <ColumnDefinition Width="150" MinWidth="80"/>
                    <ColumnDefinition Width="150" MinWidth="80"/>
                    <ColumnDefinition Width="80" MinWidth="50"/>
                    <ColumnDefinition Width="*" MinWidth="60"/>
                </Grid.ColumnDefinitions>
                
                <!-- 字段名 -->
                <TextBlock Grid.Column="0" 
                           Text="{Binding DisplayName}" 
                           Style="{StaticResource FieldNameStyle}"
                           TextTrimming="CharacterEllipsis"
                           ToolTip="{Binding DisplayName}"/>
                
                <!-- 字段值 -->
                <TextBlock Grid.Column="1" 
                           Text="{Binding Value}" 
                           Style="{StaticResource FieldValueStyle}"
                           TextTrimming="CharacterEllipsis"
                           ToolTip="{Binding Value}"/>
                
                <!-- 类型 -->
                <TextBlock Grid.Column="2" 
                           Text="{Binding TypeName}" 
                           Style="{StaticResource TypeNameStyle}"
                           TextTrimming="CharacterEllipsis"
                           ToolTip="{Binding TypeName}"/>
                
                <!-- 大小 -->
                <TextBlock Grid.Column="3" 
                           Text="{Binding Size}" 
                           Style="{StaticResource SizeStyle}"
                           TextAlignment="Right"/>
                
                <!-- 备注 -->
                <TextBlock Grid.Column="4" 
                           Text="{Binding Notes}" 
                           Style="{StaticResource NotesStyle}"
                           TextTrimming="CharacterEllipsis"
                           ToolTip="{Binding Notes}"/>
            </Grid>
        </HierarchicalDataTemplate>
    </UserControl.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- DevExpress TreeListControl -->
        <dxg:TreeListControl x:Name="FieldsTreeList"
                             Grid.Row="0"
                             Grid.RowSpan="2"
                             ShowBorder="True"
                             SelectionMode="Row">
            <dxg:TreeListControl.View>
                <dxg:TreeListView AutoWidth="False"
                                  NavigationStyle="Row"
                                  AllowEditing="False"
                                  ShowIndicator="False"
                                  TreeDerivationMode="ChildNodesSelector"
                                  ChildNodesPath="Children"
                                  ShowVerticalLines="False"
                                  ShowHorizontalLines="True"
                                  AllowPerPixelScrolling="True"
                                  AllowCascadeUpdate="True"
                                  AllowSorting="False"/>
            </dxg:TreeListControl.View>
            
            <dxg:TreeListControl.Columns>
                <!-- Name 列 -->
                <dxg:TreeListColumn Header="Name" 
                                    FieldName="DisplayName" 
                                    Width="200">
                    <dxg:TreeListColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Row.DisplayName}" 
                                       FontFamily="Consolas"
                                       Foreground="#333333"
                                       TextTrimming="CharacterEllipsis"
                                       ToolTip="{Binding Row.DisplayName}"/>
                        </DataTemplate>
                    </dxg:TreeListColumn.CellTemplate>
                </dxg:TreeListColumn>

                <!-- Value 列 -->
                <dxg:TreeListColumn Header="Value" 
                                    FieldName="Value" 
                                    Width="150">
                    <dxg:TreeListColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Row.Value}" 
                                       FontFamily="Consolas"
                                       Foreground="#0066CC"
                                       TextTrimming="CharacterEllipsis"
                                       ToolTip="{Binding Row.Value}"/>
                        </DataTemplate>
                    </dxg:TreeListColumn.CellTemplate>
                </dxg:TreeListColumn>

                <!-- Type 列 -->
                <dxg:TreeListColumn Header="Type" 
                                    FieldName="TypeName" 
                                    Width="150">
                    <dxg:TreeListColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Row.TypeName}" 
                                       FontFamily="Consolas"
                                       Foreground="#666666"
                                       FontStyle="Italic"
                                       TextTrimming="CharacterEllipsis"
                                       ToolTip="{Binding Row.TypeName}"/>
                        </DataTemplate>
                    </dxg:TreeListColumn.CellTemplate>
                </dxg:TreeListColumn>

                <!-- Size 列 -->
                <dxg:TreeListColumn Header="Size" 
                                    FieldName="Size" 
                                    Width="80">
                    <dxg:TreeListColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Row.Size}" 
                                       FontFamily="Consolas"
                                       Foreground="#999999"
                                       TextAlignment="Right"/>
                        </DataTemplate>
                    </dxg:TreeListColumn.CellTemplate>
                </dxg:TreeListColumn>

                <!-- Notes 列 -->
                <dxg:TreeListColumn Header="Notes" 
                                    FieldName="Notes" 
                                    Width="*">
                    <dxg:TreeListColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Row.Notes}" 
                                       FontFamily="Consolas"
                                       Foreground="#CC6600"
                                       FontStyle="Italic"
                                       TextTrimming="CharacterEllipsis"
                                       ToolTip="{Binding Row.Notes}"/>
                        </DataTemplate>
                    </dxg:TreeListColumn.CellTemplate>
                </dxg:TreeListColumn>
            </dxg:TreeListControl.Columns>
        </dxg:TreeListControl>

        <!-- 无数据提示 -->
        <TextBlock x:Name="NoDataMessage"
                   Grid.Row="1"
                   Text="No managed object selected"
                   Foreground="Gray"
                   FontStyle="Italic"
                   HorizontalAlignment="Center"
                   VerticalAlignment="Center"
                   Visibility="Collapsed"/>
    </Grid>
</UserControl>

